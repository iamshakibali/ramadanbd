<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>рж░ржоржЬрж╛ржи рзирзжрзирзм тАФ ржмрж╛ржВрж▓рж╛ржжрзЗрж╢</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Tiro+Bangla&family=Inter:wght@400;700;800&family=Amiri&family=Noto+Sans+Arabic:wght@400;700&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  :root {
    --bg: #F0F9F4;
    --card-bg: #FFFFFF;
    --text-main: #1A2F23;
    --text-muted: #64748B;
    --accent-green: #10B981;
    --border: #E2E8F0;
    --sahur-grad: #DCFCE7;
    --iftar-grad: #E2F0D9;
    --status-bg: #064E3B;
  }
  body {
    font-family: 'Tiro Bangla', serif;
    background-color: var(--bg);
    color: var(--text-main);
    min-height: 100vh;
    padding-bottom: 20px;
    -webkit-font-smoothing: antialiased;
  }
  .en-font { font-family: 'Inter', sans-serif; letter-spacing: -0.02em; }
  
  .ar-font { 
    font-family: 'Amiri', serif; 
    direction: rtl; 
    unicode-bidi: isolate; 
    font-size: 1.1rem;
    line-height: 1.6;
    color: #064E3B;
    margin-bottom: 10px;
    display: block;
  }

  .text-small-ar { font-size: 1.1rem; }
  .uccharon { font-size: 15px; color: #475569; margin-bottom: 8px; font-style: italic; line-height: 1.5; }
  .onubad { font-size: 16px; color: #1E293B; font-weight: 500; margin-bottom: 8px; line-height: 1.5; }
  .source { font-size: 13px; color: var(--accent-green); font-weight: 700; opacity: 0.8; }

  #loader { position: fixed; inset: 0; background: var(--bg); display: flex; align-items: center; justify-content: center; z-index: 150; font-weight: bold; font-size: 1.2rem; }
  
  #splash { position: fixed; inset: 0; background: var(--bg); display: flex; align-items: center; justify-content: center; z-index: 100; padding: 20px; }
  .splash-card { background: var(--card-bg); border-radius: 28px; padding: 25px; width: 100%; max-width: 400px; box-shadow: 0 10px 30px rgba(0,0,0,0.03); text-align: center; }
  .zila-list { max-height: 300px; overflow-y: auto; border: 1px solid var(--border); border-radius: 12px; margin-top: 15px; text-align: left; }
  .zila-item { padding: 12px 15px; cursor: pointer; border-bottom: 1px solid #f9f9f9; font-weight: 600; }
  .zila-item:hover { background: var(--bg); color: var(--accent-green); }

  #app { display: none; max-width: 1100px; margin: 0 auto; padding: 20px; }

  .status-card {
    background: var(--status-bg);
    border-radius: 30px;
    padding: 30px;
    margin-bottom: 20px;
    color: white;
    box-shadow: 0 10px 30px rgba(6, 78, 59, 0.15);
  }
  
  .status-top {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 25px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    padding-bottom: 20px;
  }
  
  .date-info .hijri { font-size: 22px; font-weight: 800; }
  .date-info .gregorian { font-size: 14px; opacity: 0.7; margin-top: 4px; }
  
  .city-box { text-align: right; cursor: pointer; }
  .city-box .city { font-size: 20px; font-weight: 800; }
  .city-box .change { color: #10B981; font-size: 12px; font-weight: 700; text-decoration: underline; margin-top: 2px; }

  .status-bottom {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .status-info { display: flex; align-items: center; gap: 15px; }
  .status-info svg { width: 28px; height: 28px; color: #10B981; }
  .status-text h2 { font-size: 22px; font-weight: 700; }
  .status-text p { font-size: 14px; opacity: 0.8; }
  
  .status-badge {
    background: rgba(255,255,255,0.1);
    padding: 12px 18px;
    border-radius: 20px;
    text-align: center;
    backdrop-filter: blur(10px);
    min-width: 90px;
  }
  .status-badge .num { font-size: 24px; font-weight: 800; display: block; color: #10B981; }
  .status-badge .label { font-size: 11px; opacity: 0.7; }

  .layout-grid { display: grid; grid-template-columns: 1fr; gap: 20px; }
  @media (min-width: 992px) { .layout-grid { grid-template-columns: 450px 1fr; align-items: start; } .sticky-col { position: sticky; top: 20px; } }

  .hero-container { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
  .hero-card { border-radius: 30px; padding: 25px; height: 210px; display: flex; flex-direction: column; justify-content: space-between; border: 2px solid transparent; transition: border-color 0.3s ease; }
  .card-sahur { background: var(--sahur-grad); }
  .card-iftar { background: var(--iftar-grad); }
  .hero-card label { font-size: 15px; color: #334155; font-weight: 600; }
  .hero-card .event { font-size: 22px; font-weight: 800; margin-top: 4px; color: #064E3B; }
  .hero-card .time { font-size: 34px; font-weight: 800; font-family: 'Inter', sans-serif; color: #0F172A; margin: 10px 0; }
  .hero-card .sub { font-size: 14px; color: #475569; font-weight: 600; }

  .summary-bar { background: white; border-radius: 20px; padding: 20px; display: flex; justify-content: space-around; box-shadow: 0 4px 15px rgba(0,0,0,0.02); margin-bottom: 20px; }
  .summary-item { text-align: center; }
  .summary-label { font-size: 13px; color: var(--text-muted); font-weight: 700; margin-bottom: 5px; }
  .summary-time { font-size: 18px; font-weight: 800; font-family: 'Inter', sans-serif; color: #064E3B; }

  .toggle-container { display: flex; background: #E2E8F0; padding: 5px; border-radius: 15px; margin-bottom: 20px; gap: 5px; }
  .toggle-btn { flex: 1; border: none; padding: 12px; border-radius: 12px; font-family: 'Tiro Bangla', serif; font-size: 14px; font-weight: 700; cursor: pointer; background: transparent; color: #475569; transition: all 0.2s; }
  .toggle-btn.active { background: white; color: var(--accent-green); box-shadow: 0 2px 8px rgba(0,0,0,0.05); }

  .table-wrapper { background: white; border-radius: 25px; overflow-x: auto; border: 1px solid var(--border); }
  table { width: 100%; border-collapse: collapse; font-size: 15px; min-width: 550px; }
  th { background: #F0FDF4; padding: 12px 15px; text-align: left; color: #064E3B; font-weight: 800; }
  td { padding: 12px 15px; border-bottom: 1px solid #F1F5F9; font-weight: 500; }
  tr.today-row { background: #F0FDF4; border-left: 6px solid var(--accent-green); }

  .dua-card { background: white; border-radius: 25px; padding: 25px; margin-bottom: 15px; border: 1px solid var(--border); }
  .dua-title { font-size: 18px; font-weight: 800; color: #065F46; margin-bottom: 15px; border-bottom: 1px solid var(--border); padding-bottom: 8px; }

  .salat-list { display: flex; flex-direction: column; gap: 12px; }
  .salat-item { 
    display: flex; 
    align-items: center; 
    justify-content: space-between; 
    background: #F8FAFC; 
    padding: 18px 22px; 
    border-radius: 20px; 
    cursor: pointer;
    transition: all 0.2s;
  }
  .salat-item.completed { background: #DCFCE7; }
  .salat-check { 
    width: 26px; height: 26px; border-radius: 8px; border: 2px solid #CBD5E1; 
    display: flex; align-items: center; justify-content: center; background: white;
  }
  .completed .salat-check { background: #10B981; border-color: #10B981; }
  .salat-check svg { display: none; width: 16px; height: 16px; color: white; }
  .completed .salat-check svg { display: block; }

  .progress-container { background: #E2E8F0; border-radius: 10px; height: 10px; width: 100%; margin-bottom: 15px; overflow: hidden; }
  .progress-bar { background: #10B981; height: 100%; width: 0%; transition: width 0.4s ease; }
  .salat-reminder { background: #F0FDF4; color: #047857; padding: 12px; border-radius: 12px; font-size: 13px; font-weight: 700; margin-bottom: 15px; border: 1px solid #BBF7D0; text-align: center; }
  
  #reward-card {
    background: linear-gradient(135deg, #059669 0%, #064E3B 100%);
    color: white; display: none; padding: 25px; border-radius: 25px; text-align: center; margin-bottom: 15px; animation: bounceIn 0.8s;
  }
  .reset-btn { background: rgba(255,255,255,0.2); border: 1px solid white; color: white; padding: 8px 15px; border-radius: 10px; font-size: 13px; font-weight: 700; cursor: pointer; margin-top: 15px; }

  .modal-overlay {
    position: fixed; inset: 0; background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(5px);
    display: flex; align-items: center; justify-content: center; z-index: 200; padding: 20px; opacity: 0; visibility: hidden; transition: all 0.3s ease;
  }
  .modal-overlay.active { opacity: 1; visibility: visible; }
  .modal-content {
    background: white; width: 100%; max-width: 500px; border-radius: 30px; padding: 35px; box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
  }
  .modal-title { font-size: 24px; font-weight: 800; color: #064E3B; margin-bottom: 20px; text-align: center; }
  .feature-item { display: flex; gap: 12px; margin-bottom: 15px; color: #475569; font-size: 15px; line-height: 1.5; }
  .feature-icon { width: 22px; height: 22px; background: #10B981; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px; }
  .feature-icon svg { width: 14px; height: 14px; color: white; }
  .btn-primary { background: #064E3B; color: white; border: none; padding: 14px; border-radius: 15px; font-size: 16px; font-weight: 700; cursor: pointer; width: 100%; transition: background 0.2s; }

  @keyframes bounceIn {
    0% { transform: scale(0.3); opacity: 0; }
    50% { transform: scale(1.05); opacity: 1; }
    100% { transform: scale(1); }
  }
  
  footer { text-align: center; padding: 30px; font-size: 14px; border-top: 1px solid var(--border); margin-top: 30px; color: #64748B; }

  @media (max-width: 600px) {
    .hero-card .time { font-size: 26px; }
    #app { padding: 10px; }
    .toggle-btn { font-size: 13px; }
    .modal-content { padding: 25px; }
  }
</style>
</head>
<body>

<div id="loader">рж▓рзЛржб рж╣ржЪрзНржЫрзЗ...</div>

<div id="splash" style="display:none;">
  <div class="splash-card">
    <h1 class="splash-title" style="color: #064E3B; margin-bottom: 15px;">рж░ржоржЬрж╛ржи ржХрзНржпрж╛рж▓рзЗржирзНржбрж╛рж░ рзирзжрзирзм</h1>
    <input type="text" id="zila-search" class="search-box" style="width:100%; padding:12px; border-radius:10px; border:1px solid #ddd;" placeholder="ржЖржкржирж╛рж░ ржЬрзЗрж▓рж╛ ржЦрзБржБржЬрзБржи...">
    <div id="zila-list" class="zila-list"></div>
  </div>
</div>

<div id="app">
  <div class="status-card">
    <div class="status-top">
      <div class="date-info">
        <div class="hijri" id="hijri-display">рзи Ramadan рззрзкрзкрзн AH</div>
        <div class="gregorian" id="gregorian-display">рзирзж ржлрзЗржмрзНрж░рзБрзЯрж╛рж░рж┐ рзирзжрзирзм</div>
      </div>
      <div class="city-box" id="change-city-btn">
        <div class="city" id="city-name">ржврж╛ржХрж╛</div>
        <div class="change">ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзБржи</div>
      </div>
    </div>
    
    <div class="status-bottom">
      <div class="status-info">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="28" height="28">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.54 1.118l-3.976-2.888a1 1 0 00-1.175 0l-3.976 2.888c-.784.57-1.838-.196-1.539-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
        </svg>
        <div class="status-text">
          <h2 id="fast-status">рж░рзЛржЬрж╛ ржЪрж▓ржЫрзЗ</h2>
          <p id="fast-count">рж░рзЛржЬрж╛ рзи/рзйрзж</p>
        </div>
      </div>
      <div class="status-badge">
        <span class="num" id="fast-num">рзи</span>
        <span class="label">рж░ржоржЬрж╛ржирзЗрж░</span>
      </div>
    </div>
  </div>

  <div class="layout-grid">
    <div class="sticky-col">
      <div class="hero-container">
        <div class="hero-card card-sahur" id="card-timer">
          <div>
            <label>ржПржЦржи рж╕ржорзЯ</label>
            <div class="event" id="timer-label">рж╕рж╛рж╣рж░рж┐ ржмрж╛ржХрж┐</div>
          </div>
          <div class="time en-font" id="countdown-timer">рзжрзж:рзжрзж:рзжрзж</div>
          <div class="sub" id="duration-text">рж╕рзБржмрж╣рзЗ рж╕рж╛ржжрж┐ржХ: рзл:рззрзи</div>
        </div>
        <div class="hero-card card-iftar" id="card-next">
          <div>
            <label>ржкрж░ржмрж░рзНрждрзА ржЗржнрзЗржирзНржЯ</label>
            <div class="event" id="next-event-label">ржЗржлрждрж╛рж░ рж╢рзБрж░рзБ</div>
          </div>
          <div class="time en-font" id="next-event-time">рзл:рзлрзо рж╕ржирзНржзрзНржпрж╛</div>
          <div class="sub" id="sunset-text">рж╕рзВрж░рзНржпрж╛рж╕рзНржд: рзл:рзлрзо</div>
        </div>
      </div>

      <div class="summary-bar">
        <div class="summary-item">
          <div class="summary-label">рж╕рж╛рж╣рж░рж┐ рж╢рзЗрж╖</div>
          <div class="summary-time en-font" id="summ-sahur">--:--</div>
        </div>
        <div class="summary-item">
          <div class="summary-label">ржЗржлрждрж╛рж░ рж╢рзБрж░рзБ</div>
          <div class="summary-time en-font" id="summ-iftar">--:--</div>
        </div>
      </div>
      
      <div class="dua-card" id="hadith-section">
        <div class="dua-title">ЁЯУЦ ржЖржЬржХрзЗрж░ рж╣рж╛ржжрж┐рж╕</div>
        <div class="ar-font text-small-ar" id="hadith-ar" style="text-align:right;"></div>
        <div class="uccharon" id="hadith-uccharon"></div>
        <div class="onubad" id="hadith-bn"></div>
        <div class="source" id="hadith-source"></div>
      </div>
    </div>

    <div>
      <div class="toggle-container">
        <button class="toggle-btn active" id="tab-hadith">ржжрзЛрзЯрж╛ ржУ ржирж┐рзЯржд</button>
        <button class="toggle-btn" id="tab-salat">рж╕рж╛рж▓рж╛ржд ржЯрзНрж░рзНржпрж╛ржХрж╛рж░</button>
        <button class="toggle-btn" id="tab-schedule">ржкрзВрж░рзНржг рж╕рзВржЪрзА</button>
      </div>

      <div id="view-hadith">
        <div class="dua-card">
          <div class="dua-title">ЁЯМЩ рж╕рж╛рж╣рж░рж┐рж░ ржирж┐рзЯржд</div>
          <div class="ar-font text-small-ar" style="text-align: right;">┘Ж┘О┘И┘О┘К┘Т╪к┘П ╪г┘О┘Ж┘Т ╪г┘О╪╡┘П┘И┘Е┘О ╪║┘О╪п┘Л╪з ┘Е┘Р┘Ж┘Т ╪┤┘О┘З┘Т╪▒┘Р ╪▒┘О┘Е┘О╪╢┘О╪з┘Ж┘О ╪з┘Д┘Т┘Е┘П╪и┘О╪з╪▒┘О┘Г┘Р ┘Б┘О╪▒┘Т╪╢┘Л╪з ┘Д┘О┘Г┘О ┘К┘О╪з ╪з┘Д┘Д┘З┘П ┘Б┘О╪к┘О┘В┘О╪и┘С┘О┘Д┘Т ┘Е┘Р┘Ж┘Р┘С┘К ╪е┘Р┘Ж┘С┘О┘Г┘О ╪г┘О┘Ж┘Т╪к┘О ╪з┘Д╪│┘С┘О┘Е┘Р█М╪╣┘П ╪з┘Д┘Т╪╣┘О┘Д┘Р┘К┘Т┘Е┘П</div>
          <div class="uccharon"><strong>ржЙржЪрзНржЪрж╛рж░ржг:</strong> ржирж╛ржУржпрж╝рж╛ржЗрждрзБ ржЖржи ржЖржЫрзБржорж╛ ржЧрж╛ржжрж╛ржо ржорж┐ржи рж╢рж╛рж╣рж░рж┐ рж░рж╛ржорж╛ржжрзНржмрж╛ржирж╛рж▓ ржорзБржмрж╛рж░рж╛ржХрж┐ ржлрж╛рж░ржжрзНржмрж╛рж▓рзНрж▓рж╛ржХрж╛ ржЗржпрж╝рж╛ ржЖрж▓рзНрж▓рж╛рж╣рзБ ржлрж╛рждрж╛ржХрзНржмрж╛ржмрзНржмрж╛рж▓ ржорж┐ржирзНржирзА ржЗржирзНржирж╛ржХрж╛ ржЖржирзНрждрж╛рж╕ рж╕рж╛ржорзАржЙрж▓ ржЖрж▓рзАржоред</div>
          <div class="onubad"><strong>ржЕржирзБржмрж╛ржж:</strong> рж╣рзЗ ржЖрж▓рзНрж▓рж╛рж╣! ржЖржорж┐ ржЖржЧрж╛ржорзАржХрж╛рж▓ ржкржмрж┐рждрзНрж░ рж░ржоржЬрж╛ржирзЗрж░ рж░рзЛржЬрж╛ рж░рж╛ржЦрж╛рж░ ржирж┐ржпрж╝ржд ржХрж░рж▓рж╛ржоред рждрзБржорж┐ ржЖржорж╛рж░ ржкржХрзНрж╖ ржерзЗржХрзЗ рждрж╛ ржХржмрзБрж▓ ржХрж░, ржирж┐рж╢рзНржЪржпрж╝ржЗ рждрзБржорж┐ рж╕рж░рзНржмрж╢рзНрж░рзЛрждрж╛ ржУ рж╕рж░рзНржмржЬрзНржЮред</div>
        </div>
        <div class="dua-card">
          <div class="dua-title">ЁЯд▓ ржЗржлрждрж╛рж░рзЗрж░ ржжрзБ'ржЖ</div>
          <div class="ar-font text-small-ar" style="text-align: right;">╪з┘Д┘Д┘С┘О┘З┘П┘Е┘С┘О ┘Д┘О┘Г┘О ╪╡┘П┘Е┘Т╪к┘П ┘И┘О╪╣┘О┘Д┘О┘Й ╪▒┘Р╪▓┘Т┘В┘Р┘Г┘О ╪г┘О┘Б┘Т╪╖┘О╪▒┘Т╪к┘П</div>
          <div class="uccharon"><strong>ржЙржЪрзНржЪрж╛рж░ржг:</strong> ржЖрж▓рзНрж▓рж╛рж╣рзБржорзНржорж╛ рж▓рж╛ржХрж╛ ржЫрзБржорждрзБ ржУрзЯрж╛ ржЖрж▓рж╛ рж░рж┐ржпржХрзНржмрж┐ржХрж╛ ржЖржлрждрж╛рж░рждрзБред</div>
          <div class="onubad"><strong>ржЕржирзБржмрж╛ржж:</strong> рж╣рзЗ ржЖрж▓рзНрж▓рж╛рж╣! ржЖржорж┐ рждрзЛржорж╛рж░ржЗ рж╕ржирзНрждрзБрж╖рзНржЯрж┐рж░ ржЬржирзНржп рж░рзЛржЬрж╛ рж░рзЗржЦрзЗржЫрж┐ ржПржмржВ рждрзЛржорж╛рж░ржЗ ржжрзЗржпрж╝рж╛ рж░рж┐ржЬрж┐ржХ ржжрзНржмрж╛рж░рж╛ ржЗржлрждрж╛рж░ ржХрж░ржЫрж┐ред</div>
        </div>
      </div>

      <div id="view-salat" style="display: none;">
        <div id="reward-card">
          <h2 style="font-size: 24px;">ржорж╛рж╢рж╛ржЖрж▓рзНрж▓рж╛рж╣! ЁЯОЙ</h2>
          <p style="margin-top: 10px; font-size: 16px;">ржЖржкржирж┐ ржЖржЬржХрзЗрж░ рзл ржУржпрж╝рж╛ржХрзНржд ржирж╛ржорж╛ржЬ рж╕ржорзНржкржирзНржи ржХрж░рзЗржЫрзЗржиред</p>
          <button class="reset-btn" onclick="resetTodaySalat()">рж░рж┐рж╕рзЗржЯ ржХрж░рзБржи</button>
        </div>
        <div class="dua-card">
          <div class="dua-title">ЁЯХЛ рзл ржУржпрж╝рж╛ржХрзНржд ржирж╛ржорж╛ржЬ ржЯрзНрж░рзНржпрж╛ржХрж╛рж░</div>
          <div class="progress-container"><div class="progress-bar" id="salat-progress"></div></div>
          <div class="salat-reminder">тЪая╕П рж╕рждрж░рзНржХрждрж╛: ржирж╛ржорж╛ржЬ ржирж╛ ржкрзЬрзЗ ржЯрж┐ржХ ржжрзЗржмрзЗржи ржирж╛ред</div>
          <div class="salat-list">
            <div class="salat-item" onclick="toggleSalat('fajr')"><span class="salat-name">ржлржЬрж░</span><div class="salat-check" id="check-fajr"><svg viewBox="0 0 20 20" fill="currentColor" width="16" height="16"><path d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"/></svg></div></div>
            <div class="salat-item" onclick="toggleSalat('dhuhr')"><span class="salat-name">ржпрзЛрж╣рж░</span><div class="salat-check" id="check-dhuhr"><svg viewBox="0 0 20 20" fill="currentColor" width="16" height="16"><path d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"/></svg></div></div>
            <div class="salat-item" onclick="toggleSalat('asr')"><span class="salat-name">ржЖрж╕рж░</span><div class="salat-check" id="check-asr"><svg viewBox="0 0 20 20" fill="currentColor" width="16" height="16"><path d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"/></svg></div></div>
            <div class="salat-item" onclick="toggleSalat('maghrib')"><span class="salat-name">ржорж╛ржЧрж░рж┐ржм</span><div class="salat-check" id="check-maghrib"><svg viewBox="0 0 20 20" fill="currentColor" width="16" height="16"><path d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"/></svg></div></div>
            <div class="salat-item" onclick="toggleSalat('isha')"><span class="salat-name">ржПрж╢рж╛ ржУ рждрж╛рж░рж╛ржмрж┐</span><div class="salat-check" id="check-isha"><svg viewBox="0 0 20 20" fill="currentColor" width="16" height="16"><path d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"/></svg></div></div>
          </div>
        </div>
      </div>

      <div id="view-schedule" style="display: none;">
        <div class="table-wrapper" id="table-container"></div>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="update-modal">
    <div class="modal-content">
      <h2 class="modal-title">ржирждрзБржи ржХрж┐ ржЖржЫрзЗ?</h2>
      <div class="feature-item"><div class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></div><div>ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рзмрзкржЯрж┐ ржЬрзЗрж▓рж╛рж░ ржЬржирзНржп ржЗрж╕рж▓рж╛ржорж┐ржХ ржлрж╛ржЙржирзНржбрзЗрж╢ржирзЗрж░ ржЕржлрж┐рж╕рж┐рзЯрж╛рж▓ рж╕ржорзЯрж╕рзВржЪрзА ржПржмржВ ржлржЬрж░рзЗрж░ ржЖржЬрж╛ржи ржЖржкржбрзЗржЯ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗред</div></div>
      <div class="feature-item"><div class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></div><div>ржкрзНрж░рждрж┐ржжрж┐ржирзЗрж░ рзл ржУржпрж╝рж╛ржХрзНржд ржирж╛ржорж╛ржЬ ржЯрзНрж░рзНржпрж╛ржХ ржХрж░рж╛рж░ ржЬржирзНржп рж╕рж╛рж▓рж╛ржд ржЯрзНрж░рзНржпрж╛ржХрж╛рж░ ржПржмржВ ржкрзНрж░ржЧрзНрж░рзЗрж╕ ржмрж╛рж░ ржпрзЛржЧ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗред</div></div>
      <div class="feature-item"><div class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></div><div>ржЖрж░ржмрж┐ ржлржирзНржЯ ржлрж┐ржХрзНрж╕ ржПржмржВ ржкрзНрж░рждрж┐ рзз ржорж┐ржирж┐ржЯ ржЕржирзНрждрж░ рж╣рж╛ржжрж┐рж╕ ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ ржлрж┐ржЪрж╛рж░ред</div></div>
      <div class="feature-item"><div class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></div><div>ржкрзБрж░рзЛ ржЕрзНржпрж╛ржкрзЗрж░ ржХрж╛рж▓рж╛рж░ ржерж┐ржо ржПржЦржи ржХржирж╕рж┐рж╕рзНржЯрзЗржирзНржЯ ржЧрзНрж░рж┐ржи рж╢рзЗржбрзЗ рж╕рж╛ржЬрж╛ржирзЛ рж╣рзЯрзЗржЫрзЗред</div></div>
      <p style="font-size: 13px; color: #10B981; font-weight: 700; margin: 20px 0; text-align: center;">рж╕рзЛрж░рзНрж╕: ржЗрж╕рж▓рж╛ржорж┐ржХ ржлрж╛ржЙржирзНржбрзЗрж╢ржи ржмрж╛ржВрж▓рж╛ржжрзЗрж╢ (ржЕржлрж┐рж╕рж┐рзЯрж╛рж▓)</p>
      <button class="btn-primary" onclick="closeUpdateModal()">ржмрзБржЭрзЗржЫрж┐</button>
    </div>
  </div>

  <footer>Vibecoded by <a href="https://www.facebook.com/iamshakibali/" target="_blank" style="color: var(--accent-green); text-decoration: none; font-weight: 800;">Shakib</a> &copy; 2026</footer>
</div>

<script>
const dhakaBase = {
  sahri: ["5:12","5:11","5:11","5:10","5:09","5:08","5:08","5:07","5:06","5:05","5:05","5:04","5:03","5:02","5:01","5:00","4:59","4:58","4:57","4:57","4:56","4:55","4:54","4:53","4:52","4:51","4:50","4:49","4:48","4:47"],
  fajr: ["5:15","5:14","5:14","5:13","5:12","5:11","5:11","5:10","5:09","5:08","5:08","5:07","5:06","5:05","5:04","5:03","5:02","5:01","5:00","5:00","4:59","4:58","4:57","4:56","4:55","4:54","4:53","4:52","4:51","4:50"],
  iftar: ["5:58","5:58","5:59","5:59","6:00","6:00","6:01","6:01","6:02","6:02","6:03","6:03","6:04","6:04","6:05","6:05","6:06","6:06","6:07","6:07","6:07","6:08","6:08","6:09","6:09","6:10","6:10","6:10","6:11","6:11"]
};

const offsets = {
  "ржврж╛ржХрж╛": [0,0], "ржЧрж╛ржЬрзАржкрзБрж░": [-1,0], "ржирж╛рж░рж╛рзЯржгржЧржЮрзНржЬ": [-1,-1], "ржЯрж╛ржЩрзНржЧрж╛ржЗрж▓": [1,1], "ржорзЯржоржирж╕рж┐ржВрж╣": [-1,-1], "рж╢рзЗрж░ржкрзБрж░": [1,1], "ржЬрж╛ржорж╛рж▓ржкрзБрж░": [1,2], "ржХрж┐рж╢рзЛрж░ржЧржЮрзНржЬ": [-3,-3], "ржирзЗрждрзНрж░ржХрзЛржирж╛": [-3,-2], "рж╕рж┐рж▓рзЗржЯ": [-8,-8], "рж╕рзБржирж╛ржоржЧржЮрзНржЬ": [-6,-7], "ржорзМрж▓ржнрзАржмрж╛ржЬрж╛рж░": [-7,-8], "рж╣ржмрж┐ржЧржЮрзНржЬ": [-5,-6], "ржЪржЯрзНржЯржЧрзНрж░рж╛ржо": [-9,-5], "ржХржХрзНрж╕ржмрж╛ржЬрж╛рж░": [-10,-3], "ржХрзБржорж┐рж▓рзНрж▓рж╛": [-4,-3], "ржмрзНрж░рж╛рж╣рзНржоржгржмрж╛рзЬрж┐рзЯрж╛": [-3,-3], "ржлрзЗржирзА": [-5,-4], "ржирзЛрзЯрж╛ржЦрж╛рж▓рзА": [-4,-2], "рж▓ржХрзНрж╖рзНржорзАржкрзБрж░": [-2,-2], "ржЪрж╛ржБржжржкрзБрж░": [-2,-2], "ржЦрж╛ржЧрзЬрж╛ржЫрзЬрж┐": [-7,-5], "рж░рж╛ржЩрзНржЧрж╛ржорж╛ржЯрж┐": [-8,-5], "ржмрж╛ржирзНржжрж░ржмрж╛ржи": [-8,-4], "рж░рж╛ржЬрж╢рж╛рж╣рзА": [6,7], "ржирж╛ржЯрзЛрж░": [5,6], "ржиржУржЧрж╛ржБ": [6,5], "ржЪрж╛ржБржкрж╛ржЗржиржмрж╛ржмржЧржЮрзНржЬ": [8,9], "ржкрж╛ржмржирж╛": [3,5], "рж╕рж┐рж░рж╛ржЬржЧржЮрзНржЬ": [3,2], "ржмржЧрзБрзЬрж╛": [3,3], "ржЬрзЯржкрзБрж░рж╣рж╛ржЯ": [5,4], "ржЦрзБрж▓ржирж╛": [3,5], "ржмрж╛ржЧрзЗрж░рж╣рж╛ржЯ": [2,3], "рж╕рж╛рждржХрзНрж╖рзАрж░рж╛": [4,6], "ржпрж╢рзЛрж░": [4,6], "ржорж╛ржЧрзБрж░рж╛": [3,4], "ржЭрж┐ржирж╛ржЗржжрж╣": [4,5], "ржирзЬрж╛ржЗрж▓": [3,4], "ржХрзБрж╖рзНржЯрж┐рзЯрж╛": [5,5], "ржЪрзБрзЯрж╛ржбрж╛ржЩрзНржЧрж╛": [6,6], "ржорзЗрж╣рзЗрж░ржкрзБрж░": [7,6], "ржмрж░рж┐рж╢рж╛рж▓": [1,2], "ржнрзЛрж▓рж╛": [-2,0], "ржкржЯрзБрзЯрж╛ржЦрж╛рж▓рзА": [0,2], "ржмрж░ржЧрзБржирж╛": [1,2], "ржкрж┐рж░рзЛржЬржкрзБрж░": [2,3], "ржЭрж╛рж▓ржХрж╛ржарж┐": [1,3], "рж░ржВржкрзБрж░": [5,2], "ржжрж┐ржирж╛ржЬржкрзБрж░": [6,4], "ржЧрж╛ржЗржмрж╛ржирзНржзрж╛": [4,2], "ржХрзБрзЬрж┐ржЧрзНрж░рж╛ржо": [3,0], "рж▓рж╛рж▓ржоржирж┐рж░рж╣рж╛ржЯ": [4,2], "ржирзАрж▓ржлрж╛ржорж╛рж░рзА": [6,3], "ржкржЮрзНржЪржЧрзЬ": [8,5], "ржарж╛ржХрзБрж░ржЧрж╛ржБржУ": [8,6], "рж░рж╛ржЬржмрж╛рзЬрзА": [2,2], "рж╢рж░рзАрзЯрждржкрзБрж░": [-1,0], "ржорж╛ржжрж╛рж░рзАржкрзБрж░": [0,1], "ржЧрзЛржкрж╛рж▓ржЧржЮрзНржЬ": [1,2], "ржлрж░рж┐ржжржкрзБрж░": [1,2], "ржорж╛ржирж┐ржХржЧржЮрзНржЬ": [1,1], "ржорзБржирзНрж╕рзАржЧржЮрзНржЬ": [-1,0], "ржирж░рж╕рж┐ржВржжрзА": [-2,-1]
};

const districts = Object.keys(offsets).map(name => ({name}));
const hadiths = [
  { ar: "┘Е┘О┘Ж┘Т ╪╡┘О╪з┘Е┘О ╪▒┘О┘Е┘О╪╢┘О╪з┘Ж┘О ╪е┘Р┘К┘Е┘О╪з┘Ж┘Л╪з ┘И┘О╪з╪н┘Т╪к┘Р╪│┘О╪з╪и┘Л╪з ╪║┘П┘Б┘Р╪▒┘О ┘Д┘О┘З┘П ┘Е┘О╪з ╪к┘О┘В┘О╪п┘О┘С┘Е┘О ┘Е┘Р┘Ж┘Т ╪░┘О┘Ж┘Т╪и┘Р┘З┘Р", bn_uccharon: "ржорж╛ржи рж╕ржорж╛ рж░ржорж╛ржжрзНржмрж╛ржирж╛ ржИржорж╛ржирж╛ржи ржУржпрж╝рж╛рж╣рждрж┐рж╕рж╛ржмрж╛ржи ржЧрзБржлрж┐рж░рж╛ рж▓рж╛рж╣рзВ ржорж╛ рждрж╛ржХрзНржмрж╛ржжрзНржжрж╛ржорж╛ ржорж┐ржи ржпрж╛ржоржмрж┐рж╣рзАред", bn: "ржпрзЗ ржмрзНржпржХрзНрждрж┐ ржИржорж╛ржи ржУ рж╕ржУржпрж╝рж╛ржмрзЗрж░ ржЖрж╢рж╛ржпрж╝ рж░ржоржЬрж╛ржирзЗрж░ рж░рзЛржЬрж╛ рж░рж╛ржЦржмрзЗ, рждрж╛рж░ ржЕрждрзАрждрзЗрж░ рж╕ржм ржЧрзБржирж╛рж╣ ржХрзНрж╖ржорж╛ ржХрж░рзЗ ржжрзЗржУржпрж╝рж╛ рж╣ржмрзЗред", source: "рж╕рж╣рзАрж╣ ржмрзБржЦрж╛рж░рзА: рззрзпрзжрзз" },
  { ar: "╪з┘Д╪╡┘Р┘С┘К┘О╪з┘Е┘П ╪м┘П┘Ж┘О┘С╪й┘М ┘Б┘О┘Д╪з ┘К┘О╪▒┘Т┘Б┘П╪л┘Т ┘И┘О┘Д╪з ┘К┘О╪м┘Т┘З┘О┘Д┘Т", bn_uccharon: "ржЖрж╕-рж╕рж┐ржпрж╝рж╛ржХрзБ ржЬрзБржирзНржирж╛рждрзБржи ржлрж╛рж▓рж╛ ржЗржпрж╝рж╛рж░ржлрзБржЫ ржУржпрж╝рж╛рж▓рж╛ ржЗржпрж╝рж╛ржЬрж╣рж╛рж▓ред", bn: "рж░рзЛржЬрж╛ рж╣рж▓рзЛ ржврж╛рж▓ рж╕рзНржмрж░рзВржкред рж╕рзБрждрж░рж╛ржВ рж░рзЛржЬрж╛ржжрж╛рж░ ржпрзЗржи ржЕрж╢рзНрж▓рзАрж▓ ржХржерж╛ ржирж╛ ржмрж▓рзЗ ржПржмржВ ржЬрж╛рж╣рзЗрж▓рзА ржЖржЪрж░ржг ржирж╛ ржХрж░рзЗред", source: "рж╕рж╣рзАрж╣ ржмрзБржЦрж╛рж░рзА: рззрзорзпрзк" },
  { ar: "┘Г┘П┘Д┘П┘С ╪╣┘О┘Е┘О┘Д┘Р ╪з╪и┘Т┘Ж┘Р ╪в╪п┘О┘Е┘О ┘К┘П╪╢┘О╪з╪╣┘О┘Б┘П ╪з┘Д┘Т╪н┘О╪│┘О┘Ж┘О╪й┘П ╪╣┘О╪┤┘Т╪▒┘П ╪г┘О┘Е┘Т╪л┘О╪з┘Д┘Р┘З┘О╪з ╪е┘Р┘Д┘О┘Й ╪│┘О╪и┘Т╪╣┘Р┘Е┘Р╪з╪ж┘О╪й┘Р ╪╢┘Р╪╣┘Т┘Б┘Н", bn_uccharon: "ржХрзБрж▓рзНрж▓рзБ ржЖржорж╛рж▓рж┐ржмржирж┐ ржЖржжрж╛ржорж╛ ржЗржЙржжрж╛'ржЖржлрзВрж▓ рж╣рж╛рж╕рж╛ржирж╛рждрж┐ ржЖрж╢рж░рзБ ржЖржоржЫрж╛рж▓рж┐рж╣рж╛ ржЗрж▓рж╛ рж╕рж╛ржмржпрж╝рж┐ржорж┐ржпрж╝рж╛рждрж┐ ржжрж┐'ржлрж┐ржиред", bn: "ржмржирзА ржЖржжржорзЗрж░ ржкрзНрж░рждрж┐ржЯрж┐ ржЖржорж▓рзЗрж░ рж╕ржУржпрж╝рж╛ржм рззрзж ржерзЗржХрзЗ рзнрзжрзж ржЧрзБржг ржкрж░рзНржпржирзНржд ржмрзГржжрзНржзрж┐ ржХрж░рж╛ рж╣ржпрж╝ред", source: "рж╕рж╣рзАрж╣ ржорзБрж╕рж▓рж┐ржо: рззрззрзлрзз" },
  { ar: "┘Д┘О╪о┘П┘Д┘П┘И┘Б┘П ┘Б┘О┘Е┘Р ╪з┘Д╪╡┘О┘С╪з╪ж┘Р┘Е┘Р ╪г┘О╪╖┘Т┘К┘О╪и┘П ╪╣┘Р┘Ж┘Т╪п┘О ╪з┘Д┘Д┘С┘О┘З┘Р ┘Е┘Р┘Ж┘Т ╪▒┘Р┘К╪н┘Р ╪з┘Д┘Т┘Е┘Р╪│┘Т┘Г┘Р", bn_uccharon: "рж▓рж╛ржЦрзБрж▓рзВржлрзБ ржлрж╛ржорж┐рж╕ рж╕ржпрж╝рж┐ржорж┐ ржЖрждржЗржпрж╝рж╛ржмрзБ ржЗржиржжрж╛рж▓рзНрж▓рж╛рж╣рж┐ ржорж┐ржи рж░рзАрж╣рж┐рж▓ ржорж┐рж╕ржХрж┐ред", bn: "рж░рзЛржЬрж╛ржжрж╛рж░рзЗрж░ ржорзБржЦрзЗрж░ ржШрзНрж░рж╛ржг ржЖрж▓рзНрж▓рж╛рж╣рж░ ржХрж╛ржЫрзЗ ржорж┐рж╢ржХрзЗрж░ рж╕рзБржЧржирзНржзрж┐рж░ ржЪрзЗржпрж╝рзЗржУ ржмрзЗрж╢рж┐ ржкрзНрж░рж┐ржпрж╝ред", source: "рж╕рж╣рзАрж╣ ржмрзБржЦрж╛рж░рзА: рззрзорзпрзк" }
];

let fastingData = [], countdownInterval = null, hadithInterval = null;
const toBn = s => s.toString().replace(/[0-9]/g, w => ({'0':'рзж','1':'рзз','2':'рзи','3':'рзй','4':'рзк','5':'рзл','6':'рзм','7':'рзн','8':'рзо','9':'рзп'})[w]);
const translate = t => toBn(t.replace('AM','ржнрзЛрж░').replace('PM','рж╕ржирзНржзрзНржпрж╛'));
const getFormattedDate = () => { const d=new Date(); return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`; };

function addMinutes(timeStr, mins) {
  let [h, m] = timeStr.split(':').map(Number);
  let d = new Date(); d.setHours(h, m + mins, 0);
  return `${d.getHours()}:${String(d.getMinutes()).padStart(2,'0')}`;
}

const renderZila = f => {
  const el = document.getElementById('zila-list');
  if (!el) return;
  el.innerHTML = "";
  districts.filter(d => d.name.includes(f)).forEach(z => {
    const dv = document.createElement('div');
    dv.className = "zila-item";
    dv.textContent = z.name;
    dv.onclick = () => {
      localStorage.setItem('selected_zila', JSON.stringify(z));
      startApp(z);
    };
    el.appendChild(dv);
  });
};

async function startApp(zila) {
  document.getElementById('loader').style.display = 'flex';
  const off = offsets[zila.name] || [0,0];
  fastingData = dhakaBase.sahri.map((s, i) => ({
    date: new Date(2026, 1, 19 + i).toISOString().split('T')[0],
    hijri_readable: `${i+1} Ramadan 1447 AH`,
    time: { 
      sahur: addMinutes(s, off[0]) + " AM", 
      fajr: addMinutes(dhakaBase.fajr[i], off[0]) + " AM",
      iftar: addMinutes(dhakaBase.iftar[i], off[1]) + " PM"
    }
  }));

  const todayStr = getFormattedDate(), todayIdx = fastingData.findIndex(r => r.date === todayStr);
  const row = todayIdx !== -1 ? fastingData[todayIdx] : fastingData[0];
  document.getElementById('city-name').textContent = zila.name;
  const now = new Date();
  document.getElementById('gregorian-display').textContent = toBn(`${now.getDate()} ${['ржЬрж╛ржирзБрзЯрж╛рж░рж┐','ржлрзЗржмрзНрж░рзБрзЯрж╛рж░рж┐','ржорж╛рж░рзНржЪ','ржПржкрзНрж░рж┐рж▓','ржорзЗ','ржЬрзБржи','ржЬрзБрж▓рж╛ржЗ','ржЖржЧрж╕рзНржЯ','рж╕рзЗржкрзНржЯрзЗржорзНржмрж░','ржЕржХрзНржЯрзЛржмрж░','ржиржнрзЗржорзНржмрж░','ржбрж┐рж╕рзЗржорзНржмрж░'][now.getMonth()]} ${now.getFullYear()}`);
  document.getElementById('hijri-display').textContent = row.hijri_readable.replace(/[0-9]/g, w => toBn(w));
  document.getElementById('fast-count').textContent = `рж░рзЛржЬрж╛ ${toBn(todayIdx+1 || 1)}/рзйрзж`;
  document.getElementById('fast-num').textContent = toBn(todayIdx+1 || 1);

  updateUI(row); renderSchedule(fastingData); setRandomHadith(); loadSalatState();
  document.getElementById('splash').style.display = 'none'; document.getElementById('app').style.display = 'block';
  startCountdown(row);
  
  if (hadithInterval) clearInterval(hadithInterval);
  hadithInterval = setInterval(setRandomHadith, 60000);

  if (!localStorage.getItem('modal_v12')) { document.getElementById('update-modal').classList.add('active'); }
  document.getElementById('loader').style.display = 'none';
}

function updateUI(r) {
  document.getElementById('summ-sahur').textContent = translate(r.time.sahur);
  document.getElementById('summ-iftar').textContent = translate(r.time.iftar);
}

function renderSchedule(data) {
  let h = `<table><thead><tr><th>рж░рзЛржЬрж╛</th><th>рждрж╛рж░рж┐ржЦ</th><th>рж╕рж╛рж╣рж░рж┐</th><th>ржЖржЬ╪з┘Ж</th><th>ржЗржлрждрж╛рж░</th></tr></thead><tbody>`;
  const t = getFormattedDate();
  data.forEach((r, i) => {
    const d = new Date(r.date);
    h += `<tr class="${r.date===t?'today-row':''}"><td>${toBn(i+1)}</td><td>${toBn(d.getDate())}</td><td>${translate(r.time.sahur)}</td><td>${translate(r.time.fajr)}</td><td>${translate(r.time.iftar)}</td></tr>`;
  });
  document.getElementById('table-container').innerHTML = h + '</tbody></table>';
}

function setRandomHadith() {
  const h = hadiths[Math.floor(Math.random()*hadiths.length)];
  document.getElementById('hadith-ar').textContent = h.ar;
  document.getElementById('hadith-uccharon').innerHTML = `<strong>ржЙржЪрзНржЪрж╛рж░ржг:</strong> ${h.bn_uccharon}`;
  document.getElementById('hadith-bn').innerHTML = `<strong>ржЕржирзБржмрж╛ржж:</strong> ${h.bn}`;
  document.getElementById('hadith-source').textContent = `рж╕рзЛрж░рзНрж╕: ${h.source}`;
}

function toggleSalat(id) {
  const k = `salat_${getFormattedDate()}`; let s = JSON.parse(localStorage.getItem(k)) || {};
  s[id] = !s[id]; localStorage.setItem(k, JSON.stringify(s)); loadSalatState();
}

function resetTodaySalat() { localStorage.removeItem(`salat_${getFormattedDate()}`); loadSalatState(); }

function loadSalatState() {
  const ids = ['fajr', 'dhuhr', 'asr', 'maghrib', 'isha'];
  const state = JSON.parse(localStorage.getItem(`salat_${getFormattedDate()}`)) || {};
  let count = 0;
  ids.forEach(id => {
    const el = document.getElementById(`check-${id}`).parentElement;
    if (state[id]) { el.classList.add('completed'); count++; } else el.classList.remove('completed');
  });
  document.getElementById('salat-progress').style.width = (count/5)*100 + '%';
  document.getElementById('reward-card').style.display = count === 5 ? 'block' : 'none';
}

function closeUpdateModal() { document.getElementById('update-modal').classList.remove('active'); localStorage.setItem('modal_v12', 'true'); }

function startCountdown(row) {
  if (countdownInterval) clearInterval(countdownInterval);
  const tk = () => {
    const now = new Date();
    const st = parseTime(row.time.sahur, row.date), it = parseTime(row.time.iftar, row.date);
    let target, label, nLabel, nTime, nSub;
    if (now < st) {
      target = st; label = 'рж╕рж╛рж╣рж░рж┐ ржмрж╛ржХрж┐'; nLabel = 'рж╕рж╛рж╣рж░рж┐ рж╢рзЗрж╖'; nTime = row.time.sahur; nSub = `рж╕рзБржмрж╣рзЗ рж╕рж╛ржжрж┐ржХ: ${toBn(row.time.sahur.split(' ')[0])}`;
      document.getElementById('card-timer').style.borderColor = "var(--accent-green)"; document.getElementById('card-next').style.borderColor = "transparent";
    } else if (now < it) {
      target = it; label = 'ржЗржлрждрж╛рж░ ржмрж╛ржХрж┐'; nLabel = 'ржЗржлрждрж╛рж░ рж╢рзБрж░рзБ'; nTime = row.time.iftar; nSub = `рж╕рзВрж░рзНржпрж╛рж╕рзНржд: ${toBn(row.time.iftar.split(' ')[0])}`;
      document.getElementById('card-timer').style.borderColor = "transparent"; document.getElementById('card-next').style.borderColor = "#064E3B";
    } else {
      const tomorrow = fastingData.find(r => r.date > row.date);
      if (tomorrow) {
        target = parseTime(tomorrow.time.sahur, tomorrow.date); label = 'рж╕рж╛рж╣рж░рж┐ ржмрж╛ржХрж┐'; nLabel = 'рж╕рж╛рж╣рж░рж┐ рж╢рзЗрж╖'; nTime = tomorrow.time.sahur; nSub = `рж╕рзБржмрж╣рзЗ рж╕рж╛ржжрж┐ржХ: ${toBn(tomorrow.time.sahur.split(' ')[0])}`;
        document.getElementById('card-timer').style.borderColor = "var(--accent-green)"; document.getElementById('card-next').style.borderColor = "transparent";
      } else { document.getElementById('timer-label').textContent = "ржЗржлрждрж╛рж░ рж╣рзЯрзЗржЫрзЗ"; return; }
    }
    const diff = target - now, h = Math.floor(diff/3600000), m = Math.floor((diff%3600000)/60000), s = Math.floor((diff%60000)/1000);
    document.getElementById('timer-label').textContent = label;
    document.getElementById('countdown-timer').textContent = toBn(`${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`);
    document.getElementById('next-event-label').textContent = nLabel;
    document.getElementById('next-event-time').textContent = translate(nTime);
    document.getElementById('sunset-text').textContent = nSub;
  };
  tk(); countdownInterval = setInterval(tk, 1000);
}

function parseTime(s, d) {
  const [t, m] = s.split(' '); let [h, mn] = t.split(':').map(Number);
  if(m==='PM'&&h!==12)h+=12; if(m==='AM'&&h===12)h=0;
  const date = new Date(d); date.setHours(h, mn, 0, 0); return date;
}

window.onload = () => {
  const s = localStorage.getItem('selected_zila');
  if(s) startApp(JSON.parse(s)); else { document.getElementById('loader').style.display='none'; document.getElementById('splash').style.display='flex'; renderZila(""); }
};
document.getElementById('zila-search').oninput = e => renderZila(e.target.value);
document.getElementById('change-city-btn').onclick = () => { document.getElementById('app').style.display='none'; document.getElementById('splash').style.display='flex'; renderZila(""); };
document.getElementById('tab-hadith').onclick = () => switchV('view-hadith', 'tab-hadith');
document.getElementById('tab-salat').onclick = () => switchV('view-salat', 'tab-salat');
document.getElementById('tab-schedule').onclick = () => switchV('view-schedule', 'tab-schedule');
function switchV(vId, tId) {
  ['view-hadith', 'view-salat', 'view-schedule'].forEach(v => document.getElementById(v).style.display = v===vId?'block':'none');
  ['tab-hadith', 'tab-salat', 'tab-schedule'].forEach(t => {
    if (document.getElementById(t)) document.getElementById(t).classList.toggle('active', t===tId);
  });
}
</script>
</body>
</html>